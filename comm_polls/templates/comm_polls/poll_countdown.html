<!DOCTYPE html>
<html>
<head>
    <title>Poll Countdown</title>
</head>
<body>
    <h1>{{ poll.name }}</h1>
    <p>{{ poll.description }}</p>

    <h2>This poll has not started yet.</h2>
    <p>Voting begins on: {{ poll.start_date }}</p>
    <p>Time remaining: <span id="countdown"></span></p>

    <a href="{% url 'comm_polls:home' %}">Back to Polls</a>

    <script>
        const countdownElement = document.getElementById('countdown');
        const pollStartDate = new Date('{{ poll.start_date.isoformat }}');

        const updateCountdown = () => {
            const now = new Date();
            const diff = pollStartDate - now;

            if (diff <= 0) {
                countdownElement.innerHTML = 'The poll is now active!';
                window.location.reload();
                return;
            }

            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);

            countdownElement.innerHTML = `${days}d ${hours}h ${minutes}m ${seconds}s`;
        };

        setInterval(updateCountdown, 1000);
        updateCountdown();
    </script>
</body>
</html>
