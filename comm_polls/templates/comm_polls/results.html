{% extends "comm_polls/base.html" %}

{% block title %}Results: {{ poll.name }}{% endblock %}

{% block content %}
    <h1>Results for: {{ poll.name }}</h1>
    <p>Total votes: {{ poll.total_votes }}</p>

    <hr>

    <div class="showcase-results">
        {% if poll.total_votes > 0 %}
            {% for choice in choices %}
                {% with percentage|floatformat:0 as percentage_int %}
                    {% widthratio choice.votes_count poll.total_votes 100 as percentage %}                    
                    <div class="result-item {% if user_vote and user_vote.choice.id == choice.id %}voted-for{% endif %}">
                        <span class="result-label">{{ choice.name }}</span>
                        <div class="result-bar">
                            <div class="bar-fill" style="width: {{ percentage }}%;"></div>
                        </div>
                        <span class="result-percent">{{ percentage|floatformat:0 }}%</span>
                    </div>
                {% endwith %}
            {% endfor %}
        {% else %}
            <p>No votes have been cast yet.</p>
        {% endif %}
    </div>

    <hr>
    <a href="{% url 'comm_polls:home' %}" class="button-link">Back to Home</a>
{% endblock %}